# 导出得分数据功能开发

## 1. 修改背景
- 用户需要在判题页面增加“导出得分数据”的功能。
- 导出格式为 CSV，便于后续统计分析。
- 数据包含：题目名称、总分、各用户得分。

## 2. 修改内容

### 2.1 后端接口开发
- **文件**: [GradingController.java](src/main/java/com/example/quiz/controller/GradingController.java)
- **新增接口**: `/grading/exportScores`
- **逻辑**:
    1.  **权限校验**: 仅限 admin 用户访问。
    2.  **获取用户列表**: 获取所有用户，过滤掉 "admin"，并按 ID 排序（对应 `data.json` 中的顺序）。
    3.  **获取题目列表**: 按章节和排序号获取所有题目。
    4.  **生成 CSV**:
        - **表头**: 第一列空，第二列 "total"，后续列为用户名。
        - **数据行**: 每行对应一个题目。
            - 第一列: 题目名称 (`title`)。
            - 第二列: 题目总分 (`total_score`)，转换为整数。
            - 后续列: 对应用户的得分，转换为整数（未评分默认为 0）。
        - **编码**: 使用 UTF-8 并添加 BOM 头，防止 Excel 打开乱码。

### 2.2 前端页面修改
- **文件**: [grading.html](src/main/resources/templates/grading.html)
- **修改**:
    1.  在 `.export-action` 区域增加“导出得分数据”按钮，位于“导出答题数据”上方（或左侧）。
    2.  新增 `exportScores()` JavaScript 函数，负责调用后端接口并下载 CSV 文件。
    3.  复用现有的文件保存逻辑（`showSaveFilePicker` 或 动态链接下载）。

## 3. 验证结果
- 执行 `mvn clean package -DskipTests` 构建成功。
- 接口逻辑符合用户关于行列顺序和数据类型的具体要求。
